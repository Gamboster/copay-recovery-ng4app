webpackJsonp([1],{0:function(e,t){},1:function(e,t){},3:function(e,t,n){e.exports=n("cDNt")},"6kpM":function(e,t,n){"use strict";var r=n("/oeL"),o=n("koeK"),a=(n.n(o),n("nVvX")),s=(n.n(a),n("OGkG")),i=(n.n(s),n("xrDH")),c=(n.n(i),n("XKz0"));n.d(t,"a",function(){return p});var l=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(s=(a<3?o(s):a>3?o(t,n,s):o(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},d=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(){function e(e){this.http=e,this.Transaction=a.Transaction,this.Address=a.Address,this.PATHS={BIP45:["m/45'/2147483647/0","m/45'/2147483647/1"],BIP44:{testnet:["m/44'/1'/0'/0","m/44'/1'/0'/1"],livenet:["m/44'/0'/0'/0","m/44'/0'/0'/1"]}}}return e.prototype.prueba=function(e){console.log(this.fromBackup({backup:e,password:"1"},1,1,"testnet")),console.log(this.fromMnemonic({backup:"bundle truck place meadow hobby prize trial delay cost enact taxi alert"},1,1,"livenet"));var t=this.fromMnemonic({backup:"better gorilla chuckle goose orbit unique famous agree topple diary once pond"},1,1,"testnet");console.log("credentials",t);var n=this.buildWallet([t]);console.log("PRUEBA-------------",n);var r=function(e){console.log("Report:",e)};this.scanWallet(n,20,r,function(e,t){console.log("Exito!",t),e&&console.log("Error :C",e)})},e.prototype.fromBackup=function(e,t,n,r){if(!e.backup)return null;try{JSON.parse(e.backup)}catch(e){throw new Error("JSON invalid. Please copy only the text within (and including) the { } brackets around it.")}var a;try{a=o.decrypt(e.password,e.backup)}catch(e){throw new Error("Incorrect backup password")}if(a=JSON.parse(a),!a.n)throw new Error("Backup format not recognized. If you are using a Copay Beta backup and version is older than 0.10, please see: https://github.com/bitpay/copay/issues/4730#issuecomment-244522614");if(a.m!=t||a.n!=n)throw new Error("The wallet configuration (m-n) does not match with values provided.");if(a.network!=r)throw new Error("Incorrect network.");if(!a.xPrivKeyEncrypted&&!a.xPrivKey)throw new Error("The backup does not have a private key");var s=a.xPrivKey;if(a.xPrivKeyEncrypted)try{s=o.decrypt(e.xPrivPass,a.xPrivKeyEncrypted)}catch(e){throw new Error("Can not decrypt private key")}return{walletId:a.walletId,copayerId:a.copayerId,xPriv:s,derivationStrategy:a.derivationStrategy||"BIP45",addressType:a.addressType||"P2SH",m:t,n:n,network:r,from:"backup"}},e.prototype.fromMnemonic=function(e,t,n,r){if(!e.backup)return null;var o,a=e.backup,i=e.password;try{o=new s(a).toHDPrivateKey(i,r).toString()}catch(e){throw new Error("Mnemonic wallet seed is not valid.")}return{xPriv:o,derivationStrategy:"BIP44",addressType:1==n?"P2PKH":"P2SH",m:t,n:n,network:r,from:"mnemonic"}},e.prototype.buildWallet=function(e){var t;if(e=i.compact(e),0==e.length)throw new Error("No data provided");if(1!=i.uniq(i.map(e,"from")).length)throw new Error("Mixed backup sources not supported");if(t=i.pick(e[0],["walletId","derivationStrategy","addressType","m","n","network","from"]),t.copayers=i.map(e,function(e){if(e.walletId!=t.walletId)throw new Error("Backups do not belong to the same wallets.");return{copayerId:e.copayerId,xPriv:e.xPriv}}),"backup"==t.from&&i.uniq(i.compact(i.map(t.copayers,"copayerId"))).length!=t.copayers.length)throw new Error("Some of the backups belong to the same copayers");return console.log("Recovering wallet",t),t},e.prototype.getWallet=function(e,t,n,r){var o=this,a=i.map(e,function(e){return"{"==e.backup.charAt(0)?o.fromBackup(e,t,n,r):o.fromMnemonic(e,t,n,r)});return this.buildWallet(a)},e.prototype.scanWallet=function(e,t,n,r){var o;n("Getting addresses... GAP:"+t),this.getActiveAddresses(e,t,n,function(e,t){if(n("Active addresses:"+JSON.stringify(t)),e)return r(e);o=i.flatten(i.map(t,"utxo"));var a={addresses:t,balance:i.sumBy(o,"amount")};return r(null,a)})},e.prototype.getPaths=function(e){return"BIP45"==e.derivationStrategy?this.PATHS[e.derivationStrategy]:"BIP44"==e.derivationStrategy?this.PATHS[e.derivationStrategy][e.network]:void 0},e.prototype.getHdDerivations=function(e){function t(e,t,n){var r=a.HDPrivateKey(e);return n?r.deriveChild(t):r.deriveNonCompliantChild(t)}function n(e){return 1==e.length?e[0]:function(e,t){for(var n=[],r=0;r<e.length;r++)for(var o=0;o<t.length;o++)n.push(i.flatten([e[r],t[o]]));return n}(e[0],n(i.tail(e)))}var r=i.map(e.copayers,"xPriv"),o=[];return i.each(this.getPaths(e),function(e){var a=n(i.map(r,function(n,r){var o=t(n,e,!0),a=t(n,e,!1),s=[];return s.push({copayer:r+1,path:e,compliant:!0,key:o}),o.toString()!=a.toString()&&s.push({copayer:r+1,path:e,compliant:!1,key:a}),s}));o=o.concat(a)}),o},e.prototype.getActiveAddresses=function(e,t,n,r){function o(e){if(e>=d.length)return r(null,l);s=0,a(d[e],0,function(t,n){if(t)return r(t);o(e+1)})}function a(r,o,d){if(s>t)return d();var p=c.generateAddress(e,r,o);c.getAddressData(p,e.network,function(e,t){if(e)return d(e);i.isEmpty(t)?s++:(n("Address is Active!"),console.log("#Active address:",t),l.push(t),s=0),n("inactiveCount:"+s),a(r,o+1,d)})}var s,c=this,l=[],d=this.getHdDerivations(e);o(0)},e.prototype.generateAddress=function(e,t,n){var r=[],o=[];i.each([].concat(t),function(e){var t=a.HDPrivateKey(e.key),s=t.deriveChild(n).privateKey;r.push(s),o.push(s.publicKey)});var s;if("P2SH"==e.addressType)s=a.Address.createMultisig(o,e.m,e.network);else{if("P2PKH"!=e.addressType)throw new Error("Address type not supported");s=this.Address.fromPublicKey(o[0],e.network)}return{addressObject:s,pubKeys:o,privKeys:r,info:t,index:n}},e.prototype.getAddressData=function(e,t,n){var r=this;this.checkAddress(e.addressObject,t).then(function(o){o.subscribe(function(o){r.checkUtxos(e.addressObject,t).then(function(t){t.subscribe(function(t){var r={address:o.addrStr,balance:o.balance,unconfirmedBalance:o.unconfirmedBalance,utxo:t,privKeys:e.privKeys,pubKeys:e.pubKeys,info:e.info,index:e.index,isActive:o.unconfirmedTxApperances+o.txApperances>0};return r.isActive?n(null,r):n()})})})})},e.prototype.checkAddress=function(e,t){var n=this;return"testnet"==t?new Promise(function(t){t(n.http.get("https://test-insight.bitpay.com/api/addr/"+e+"?noTxList=1"))}):new Promise(function(t){t(n.http.get("https://insight.bitpay.com/api/addr/"+e+"?noTxList=1"))})},e.prototype.checkUtxos=function(e,t){var n=this;return"testnet"==t?new Promise(function(t){t(n.http.get("https://test-insight.bitpay.com/api/addr/"+e+"/utxo?noCache=1"))}):new Promise(function(t){t(n.http.get("https://insight.bitpay.com/api/addr/"+e+"/utxo?noCache=1"))})},e.prototype.createRawTx=function(e,t,n,r){if(!e||!this.Address.isValid(e))throw new Error("Please enter a valid address.");var o=parseInt((1e8*t.balance-1e8*r).toFixed(0));if(o<=0)throw new Error("Funds are insufficient to complete the transaction");try{new this.Address(e,n.network)}catch(e){throw new Error("Incorrect destination address network")}try{var a=[],s=new this.Transaction;i.each(t.addresses,function(e){e.utxo.length>0&&i.each(e.utxo,function(t){"P2SH"==n.addressType?s.from(t,e.pubKeys,n.m):s.from(t),a=a.concat(e.privKeys.slice(0,n.m))})}),s.to(e,o),s.sign(i.uniq(a));var c=s.serialize();return console.log("Raw transaction: ",c),c}catch(e){throw console.log(e),new Error("Could not build tx: "+e)}},e.prototype.txBroadcast=function(e,t){var n=this;return"testnet"==t?new Promise(function(t){t(n.http.post("https://test-insight.bitpay.com/api/tx/send",{rawtx:e}))}):new Promise(function(t){t(n.http.post("https://insight.bitpay.com/api/tx/send",{rawtx:e}))})},e}();p=l([n.i(r.c)(),d("design:paramtypes",["function"==typeof(u=void 0!==c.b&&c.b)&&u||Object])],p);var u},W675:function(e,t,n){t=e.exports=n("rP7Y")(!1),t.push([e.i,"",""]),e.exports=e.exports.toString()},"aR8+":function(e,t,n){"use strict";var r=n("fc+i"),o=n("/oeL"),a=n("bm2B"),s=n("XKz0"),i=n("wQAS");n.d(t,"a",function(){return l});var c=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(s=(a<3?o(s):a>3?o(t,n,s):o(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},l=function(){function e(){}return e}();l=c([n.i(o.b)({declarations:[i.a],imports:[r.a,a.a,s.a],providers:[],bootstrap:[i.a]})],l)},cDNt:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("/oeL"),o=n("Qa4U"),a=n("aR8+");n("p5Ee").a.production&&n.i(r.a)(),n.i(o.a)().bootstrapModule(a.a)},efyd:function(e,t){e.exports='\x3c!--The content below is only a placeholder and can be replaced.--\x3e\n<div class="container">\n\n  <form #processInputsForm="ngForm" (ngSubmit)="processInputs()" *ngIf="beforeScan">\n\n    <div class="card">\n      <div class="card-block">\n        <h4 class="card-title">WALLET CONFIGURATION</h4>\n        <div class="row">\n          <div class="form-group col-sm-6">\n            <label for="signaturesNumber">Required number of signatures</label>\n            <select class="form-control" id="signaturesNumber" name="signaturesNumber" [(ngModel)]="signaturesNumber">\n            <option *ngFor="let option of availableOptions" [ngValue]="option">{{option}}</option>\n          </select>\n          </div>\n\n          <div class="form-group col-sm-6">\n            <label for="copayersNumber">Total number of Copayers</label>\n            <select class="form-control" id="copayersNumber" name="copayersNumber" [(ngModel)]="copayersNumber" (ngModelChange)="updateCopayersForm($event)">\n            <option *ngFor="let option of availableOptions" [ngValue]="option">{{option}}</option>\n          </select>\n          </div>\n\n          <div class="form-group col-sm-6">\n            <label for="network">Network</label>\n            <select class="form-control" id="network" name="network" [(ngModel)]="network">\n            <option *ngFor="let network of availableNetworks" [ngValue]="network">{{network}}</option>\n          </select>\n          </div>\n\n          <div class="form-group col-sm-6">\n            <label for="addressGap">Address Gap</label><small> (Usually does not need to be changed)</small>\n            <input type="number" class="form-control" id="addressGap" name="addressGap" [(ngModel)]="addressGap" required>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class="card" *ngFor="let copayer of copayers">\n      <div class="card-block">\n        <h6 class="card-title">Backup for copayer {{copayer}}:</h6>\n        <div class="row">\n          <div class="form-group col-sm-6">\n            <label for="dataBackUp">Mnemonic or exported wallet data</label>\n            <input type="text" class="form-control" id="dataBackUp" name="dataBackUp" [(ngModel)]="data.backUp[copayer]">\n          </div>\n\n          <div class="form-group col-sm-6">\n            <label for="contentFile">Or upload a file:</label>\n            <input type="file" class="form-control-file" id="contentFile" name="contentFile" accept=".json, .txt" aria-describedby="contentFileHelp"\n              (change)="fileChangeEvent($event)">\n            <small id="fileHelp" class="form-text text-muted">Extensions accepted: .json, .txt</small>\n          </div>\n        </div>\n\n        <div class="form-group">\n          <label for="dataPass">Password:</label>\n          <input type="password" class="form-control" id="dataPass" name="dataPass" [(ngModel)]="data.pass[copayer]">\n        </div>\n\n        <div class="form-group">\n          <label for="dataPassX">Encrypted private key password</label><small> (in case you have one)</small>\n          <input type="password" class="form-control" id="dataPassX" name="dataPassX" [(ngModel)]="data.passX[copayer]">\n        </div>\n      </div>\n    </div>\n\n    <button type="submit" [disabled]="!processInputsForm.form.valid" class="btn btn-primary btn-lg btn-block">Scan wallet</button>\n  </form>\n\n  <form #sendFundsForm="ngForm" (ngSubmit)="sendFunds(destinationAddress)" *ngIf="!beforeScan">\n    <div class="form-group panel">\n      <label>{{totalBalance}}</label>\n      <div class="input-group">\n        <div class="input-group-addon">Destination Address:</div>\n        <input type="text" class="form-control" id="destinationAddress" name="destinationAddress" [(ngModel)]="destinationAddress"\n          required>\n      </div>\n    </div>\n    <button type="submit" [disabled]="!sendFundsForm.form.valid" class="btn btn-primary btn-lg btn-block">Transfer</button>\n  </form>\n</div>'},n7du:function(e,t){function n(e){throw new Error("Cannot find module '"+e+"'.")}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="n7du"},p5Ee:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r={production:!1}},wQAS:function(e,t,n){"use strict";var r=n("/oeL"),o=n("xrDH"),a=(n.n(o),n("6kpM"));n.d(t,"a",function(){return c});var s=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(s=(a<3?o(s):a>3?o(t,n,s):o(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},c=function(){function e(e){this.RecoveryService=e,this.copayers=[1],this.addressGap=20,this.data={backUp:[],pass:[],passX:[],gap:this.addressGap},this.availableOptions=[1,2,3,4,5,6],this.availableNetworks=["livenet","testnet"],this.fee=1e-4,this.signaturesNumber=this.availableOptions[0],this.copayersNumber=this.availableOptions[0],this.network=this.availableNetworks[0]}return e.prototype.ngOnInit=function(){this.beforeScan=!0,this.destinationAddress=""},e.prototype.updateCopayersForm=function(){this.copayers=o.map(o.range(1,this.copayersNumber+1),function(e){return e})},e.prototype.processInputs=function(){var e=this,t=this;this.beforeScan=!0;var n=o.map(o.range(1,this.copayersNumber+1),function(e){return{backup:t.data.backUp[e]||"",password:t.data.pass[e]||"",xPrivPass:t.data.passX[e]||""}});try{this.wallet=this.RecoveryService.getWallet(n,this.signaturesNumber,this.copayersNumber,this.network)}catch(e){return this.showMessage(e.message,3)}this.showMessage("Scanning funds...",1);var r=function(e){console.log("Report:",e)},a=+this.addressGap;a=a||20,this.RecoveryService.scanWallet(this.wallet,a,r,function(t,n){if(t)return e.showMessage(t,3);e.scanResults=n,console.log("## Total balance:",e.scanResults.balance.toFixed(8)+" BTC"),e.showMessage("Search completed",2),e.beforeScan=!1,e.totalBalance="Available balance: "+e.scanResults.balance.toFixed(8)+" BTC",e.scanResults.balance-e.fee<=0&&(e.totalBalance+=". Insufficents funds.")})},e.prototype.sendFunds=function(e){var t,n=this;try{t=this.RecoveryService.createRawTx(e,this.scanResults,this.wallet,this.fee)}catch(e){return this.showMessage(e.message,3)}this.RecoveryService.txBroadcast(t,this.network).then(function(t){t.subscribe(function(t){n.showMessage((n.scanResults.balance-n.fee).toFixed(8)+" BTC sent to address: "+e,2),console.log("Transaction complete. "+(n.scanResults.balance-n.fee)+" BTC sent to address: "+e)})},function(e){this.showMessage("Could not broadcast transaction. Please, try later.",3)})},e.prototype.showMessage=function(e,t){1==t?(this.statusMessage=e,this.successMessage=null,this.errorMessage=null):2==t?(this.successMessage=e,this.statusMessage=null,this.errorMessage=null):3==t&&(this.errorMessage=e,this.statusMessage=null,this.successMessage=null)},e}();c=s([n.i(r._5)({selector:"app-root",template:n("efyd"),styles:[n("W675")],providers:[a.a]}),i("design:paramtypes",["function"==typeof(l=void 0!==a.a&&a.a)&&l||Object])],c);var l}},[3]);